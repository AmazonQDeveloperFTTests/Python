from math import ceil
from hashlib import sha256

def fdh(string, n=256):
    '''full domain hash of 'string' using SHA256 with digest of n-1 bits. Generates a hash with an arbitray bit size given as input (n)'''
    
    result = []
    
    for i in range(ceil(n/256)): #produce enough sha256 digests to make total 'n' bit composite digest
        
        result.append( sha256((string+str(i)).encode()).hexdigest() )
        
    result = ''.join(result)[:-1]
    
    return result
